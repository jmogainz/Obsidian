- [ ] add debug logging
- [ ] break apart refactor